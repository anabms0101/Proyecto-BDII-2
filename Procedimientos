CREATE OR REPLACE PROCEDURE insertar_cliente(store_id int,nombre TEXT, apellido text,  email TEXT, address_id int, active int)
LANGUAGE plpgsql
AS $$
BEGIN
    INSERT INTO customer(store_id, first_name, last_name, email, address_id, active)
    VALUES (store_id, nombre, apellido, email, address_id, active);
	RAISE NOTICE 'El cliente se ha incertado correctamente :)';
END;
$$;



CREATE PROCEDURE registrar_alquiler(inventory_id int, nombre text, apellido text, staff_id int)
LANGUAGE plpgsql
AS $$
DECLARE
    cust_id int;
BEGIN
	select customer_id into cust_id from customer where first_name = nombre and last_name = apellido;
    INSERT INTO rental(inventory_id, customer_id, staff_id)
    VALUES (inventory_id, cust_id, staff_id);
END;
$$;


CREATE PROCEDURE registrar_devolucion(rental_id int, return_date date)
LANGUAGE plpgsql
AS $$
BEGIN
    UPDATE rental
    SET return_date = return_date
    WHERE rental.rental_id = rental_id;
END;
$$;



CREATE FUNCTION buscar_pelicula(titulo TEXT)
RETURNS TEXT
LANGUAGE plpgsql
AS $$
DECLARE
    mensaje TEXT;
    id1 INT;
    descr TEXT;
    anio INT;
BEGIN
    SELECT film_id, description, release_year
    INTO id1, descr, anio
    FROM film
    WHERE title = titulo;

    mensaje := 'El id de este film es: ' || id1 || ', ' || descr || ', su a√±o de lanzamiento es: ' || anio;

    RETURN mensaje;
END;
$$;
